# Campus Moments Go API

## ğŸš€ é¡¹ç›®ç®€ä»‹

Campus Moments æ˜¯ä¸€ä¸ªåŸºäº Go è¯­è¨€å¼€å‘çš„æ ¡å›­åŠ¨æ€åˆ†äº«å¹³å°åç«¯APIæœåŠ¡ï¼Œæä¾›ç”¨æˆ·è®¤è¯ã€åŠ¨æ€å‘å¸ƒã€æ–‡ä»¶ä¸Šä¼ ã€å†…å®¹æœç´¢ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## ğŸ“‹ æŠ€æœ¯æ ˆ

### åç«¯æ¡†æ¶
- **Go 1.21+** - ä¸»è¦ç¼–ç¨‹è¯­è¨€
- **Gin** - Webæ¡†æ¶ï¼Œæä¾›é«˜æ€§èƒ½HTTPæœåŠ¡
- **GORM** - ORMæ¡†æ¶ï¼Œæ”¯æŒMySQLæ•°æ®åº“æ“ä½œ

### æ•°æ®åº“
- **MySQL 8.0** - ä¸»æ•°æ®åº“
- **åŸç”ŸSQL + GORM** - åŒé‡æ•°æ®åº“è®¿é—®æ¨¡å¼

### è®¤è¯ä¸å®‰å…¨
- **JWT (JSON Web Token)** - ç”¨æˆ·è®¤è¯
- **bcrypt** - å¯†ç åŠ å¯†
- **ä¸­é—´ä»¶** - è¯·æ±‚æ‹¦æˆªå’Œæƒé™éªŒè¯

### æ–‡æ¡£
- **OpenAPI 3.0** - APIæ¥å£æ–‡æ¡£
- **Swagger** - äº¤äº’å¼APIæ–‡æ¡£

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
campus-moments-go/
â”œâ”€â”€ cmd/                    # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ main.go        # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ internal/               # å†…éƒ¨åŒ…
â”‚   â”œâ”€â”€ handlers/          # HTTPå¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ auth_handler.go
â”‚   â”‚   â”œâ”€â”€ user_handler.go
â”‚   â”‚   â”œâ”€â”€ moment_handler.go
â”‚   â”‚   â””â”€â”€ upload_handler.go
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.go
â”‚   â”‚   â”œâ”€â”€ moment.go
â”‚   â”‚   â””â”€â”€ db.go
â”‚   â”œâ”€â”€ middleware/        # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ auth.go
â”‚   â”œâ”€â”€ routes/            # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ routes.go
â”‚   â””â”€â”€ service/           # ä¸šåŠ¡é€»è¾‘å±‚
â”‚       â”œâ”€â”€ auth_service.go
â”‚       â”œâ”€â”€ user_service.go
â”‚       â””â”€â”€ moment_service.go
â”œâ”€â”€ pkg/                   # å…¬å…±åŒ…
â”‚   â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database/         # æ•°æ®åº“è¿æ¥
â”‚   â””â”€â”€ jwt/              # JWTå·¥å…·
â”œâ”€â”€ docs/                 # æ–‡æ¡£ç›®å½•
â”œâ”€â”€ go.mod               # Goæ¨¡å—æ–‡ä»¶
â”œâ”€â”€ go.sum               # ä¾èµ–é”å®šæ–‡ä»¶
â”œâ”€â”€ .env                 # ç¯å¢ƒé…ç½®
â”œâ”€â”€ .env.example         # é…ç½®æ¨¡æ¿
â””â”€â”€ openapi.json         # OpenAPIè§„èŒƒ
```

## ğŸ”§ æ ¸å¿ƒæ¨¡å—

### 1. è®¤è¯æ¨¡å— (`internal/handlers/auth_handler.go`)
- ç”¨æˆ·æ³¨å†Œ/ç™»å½•/é€€å‡º
- JWT Tokenç®¡ç†
- å¯†ç ä¿®æ”¹
- ç”¨æˆ·èµ„æ–™ç®¡ç†

**ä¸»è¦æ¥å£ï¼š**
- `POST /auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/users/profile` - è·å–ç”¨æˆ·èµ„æ–™
- `PUT /api/users/password` - ä¿®æ”¹å¯†ç 

### 2. åŠ¨æ€æ¨¡å— (`internal/handlers/moment_handler.go`)
- åŠ¨æ€å‘å¸ƒ/ç¼–è¾‘/åˆ é™¤
- åŠ¨æ€åˆ—è¡¨è·å–
- åŠ¨æ€è¯¦æƒ…æŸ¥çœ‹

**ä¸»è¦æ¥å£ï¼š**
- `GET /moments` - è·å–åŠ¨æ€åˆ—è¡¨
- `POST /api/moments` - å‘å¸ƒåŠ¨æ€
- `GET /api/moments/:id` - è·å–åŠ¨æ€è¯¦æƒ…
- `PATCH /api/moments/:id` - ç¼–è¾‘åŠ¨æ€
- `DELETE /api/moments/:id` - åˆ é™¤åŠ¨æ€

### 3. æ–‡ä»¶ä¸Šä¼ æ¨¡å— (`internal/handlers/upload_handler.go`)
- å›¾ç‰‡ä¸Šä¼ 
- å¤´åƒä¸Šä¼ 
- æ–‡ä»¶ç±»å‹éªŒè¯
- å¤§å°é™åˆ¶

**ä¸»è¦æ¥å£ï¼š**
- `POST /api/upload/file` - é€šç”¨æ–‡ä»¶ä¸Šä¼ 
- `POST /api/upload/avatar` - å¤´åƒä¸Šä¼ 

### 4. æœç´¢æ¨¡å— (`internal/handlers/search_handler.go`)
- å†…å®¹æœç´¢
- çƒ­è¯ç»Ÿè®¡
- æœç´¢å†å²
- å†…å®¹ç­›é€‰

**ä¸»è¦æ¥å£ï¼š**
- `GET /api/search` - æœç´¢å†…å®¹
- `GET /api/search/hot-words` - çƒ­é—¨å…³é”®è¯
- `GET /api/search/history` - æœç´¢å†å²

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Go 1.21+
- MySQL 8.0+
- Git

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/Yw332/campus-moments-go.git
cd campus-moments-go
```

2. **å®‰è£…ä¾èµ–**
```bash
go mod download
```

3. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“ç­‰ä¿¡æ¯
```

4. **å¯åŠ¨åº”ç”¨**
```bash
go run cmd/api/main.go
```

5. **è®¿é—®æœåŠ¡**
- APIæœåŠ¡ï¼š`http://localhost:8080`
- å¥åº·æ£€æŸ¥ï¼š`http://localhost:8080/health`

### éƒ¨ç½²

#### CNBäº‘åŸç”Ÿå¹³å°
é¡¹ç›®æ”¯æŒCNBäº‘åŸç”Ÿå¹³å°éƒ¨ç½²ï¼Œä½¿ç”¨Procfileé…ç½®ï¼š

```procfile
web: ./start.sh
```

#### Dockeréƒ¨ç½²ï¼ˆæœªæ¥æ”¯æŒï¼‰
```bash
# æ„å»ºé•œåƒ
docker build -t campus-moments-go .

# è¿è¡Œå®¹å™¨
docker run -p 8080:8080 campus-moments-go
```

## ğŸ“š APIæ–‡æ¡£

- **ç”¨æˆ·è®¤è¯æ¥å£**: [API_AUTH_DOCS.md](./API_AUTH_DOCS.md)
- **OpenAPIè§„èŒƒ**: [openapi.json](./openapi.json)
- **åœ¨çº¿æ–‡æ¡£**: å¯åŠ¨æœåŠ¡åè®¿é—® `/swagger/index.html`

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### âœ… å·²å®ç°
- [x] ç”¨æˆ·æ³¨å†Œ/ç™»å½•è®¤è¯
- [x] JWT Tokenè®¤è¯æœºåˆ¶
- [x] åŠ¨æ€å‘å¸ƒå’Œæµè§ˆ
- [x] æ–‡ä»¶ä¸Šä¼ ï¼ˆå›¾ç‰‡ã€å¤´åƒï¼‰
- [x] å†…å®¹æœç´¢å’Œç­›é€‰
- [x] ç”¨æˆ·èµ„æ–™ç®¡ç†
- [x] å“åº”å¼é”™è¯¯å¤„ç†
- [x] è¯¦ç»†çš„APIæ–‡æ¡£

### ğŸš§ å¼€å‘ä¸­
- [ ] è¯„è®ºç³»ç»Ÿ
- [ ] ç‚¹èµåŠŸèƒ½
- [ ] æ¶ˆæ¯é€šçŸ¥
- [ ] ç”¨æˆ·å…³æ³¨ç³»ç»Ÿ

### ğŸ“‹ è®¡åˆ’ä¸­
- [ ] å›¾ç‰‡å‹ç¼©å¤„ç†
- [ ] ç¼“å­˜æœºåˆ¶ä¼˜åŒ–
- [ ] æ¥å£é™æµ
- [ ] æ—¥å¿—ç³»ç»Ÿå®Œå–„
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **å¯†ç åŠ å¯†**: ä½¿ç”¨bcryptåŠ å¯†å­˜å‚¨ç”¨æˆ·å¯†ç 
- **JWTè®¤è¯**: 7å¤©æœ‰æ•ˆæœŸçš„å®‰å…¨Tokenè®¤è¯
- **å‚æ•°éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥å‚æ•°éªŒè¯
- **CORSæ”¯æŒ**: è·¨åŸŸè¯·æ±‚å®‰å…¨æ§åˆ¶
- **SQLæ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨GORMé˜²æ­¢SQLæ³¨å…¥

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

- **æ•°æ®åº“è¿æ¥æ± **: ä¼˜åŒ–æ•°æ®åº“è¿æ¥ç®¡ç†
- **Ginæ¡†æ¶**: é«˜æ€§èƒ½HTTPæœåŠ¡
- **å“åº”ç¼“å­˜**: é™æ€èµ„æºç¼“å­˜æœºåˆ¶
- **ä¼˜é›…é™çº§**: æ•°æ®åº“è¿æ¥å¤±è´¥æ—¶çš„å®¹é”™å¤„ç†

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-12-13)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ¨ å®Œæˆç”¨æˆ·è®¤è¯æ¨¡å—
- âœ¨ å®ç°åŠ¨æ€å‘å¸ƒåŠŸèƒ½
- âœ¨ æ·»åŠ æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- âœ¨ é›†æˆå†…å®¹æœç´¢åŠŸèƒ½
- ğŸ“š å®Œå–„APIæ–‡æ¡£

## ğŸ“ è”ç³»æ–¹å¼

- **å¼€å‘è€…**: Yw332
- **GitHub**: https://github.com/Yw332/campus-moments-go
- **Issues**: https://github.com/Yw332/campus-moments-go/issues

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚